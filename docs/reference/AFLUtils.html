<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>AFL utility functions — AFLUtils • arrayop</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="AFL utility functions — AFLUtils" />
<meta property="og:description" content="Normally we don't need these functions.
But in case we do, they are flexible in constructing high-order
AFL expressions, e.g. AFL raw string or expressions generated in one place and
used in other places with or without modification." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">arrayop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/arrayop.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/semi_join.html">Semi Join</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Paradigm4/ArrayOpR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>AFL utility functions</h1>
    <small class="dont-index">Source: <a href='https://github.com/Paradigm4/ArrayOpR/blob/master/R/afl_utils.R'><code>R/afl_utils.R</code></a></small>
    <div class="hidden name"><code>AFLUtils.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Normally we don't need these functions.
But in case we do, they are flexible in constructing high-order
AFL expressions, e.g. AFL raw string or expressions generated in one place and
used in other places with or without modification.</p>
    </div>



    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Public methods</h3>

<ul>
<li><p><a href='#method-e_to_afl'><code>AFLUtils$e_to_afl()</code></a></p></li>
<li><p><a href='#method-args_to_expressions'><code>AFLUtils$args_to_expressions()</code></a></p></li>
<li><p><a href='#method-e'><code>AFLUtils$e()</code></a></p></li>
<li><p><a href='#method-e_merge'><code>AFLUtils$e_merge()</code></a></p></li>
<li><p><a href='#method-join_fields'><code>AFLUtils$join_fields()</code></a></p></li>
<li><p><a href='#method-validate_filter_expr'><code>AFLUtils$validate_filter_expr()</code></a></p></li>
</ul>
<p><hr>
<a id="method-e_to_afl"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>e_to_afl()</code></h3>
<p>Convert filter expression(s) to AFL filter</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AFLUtils</span><span class='op'>$</span><span class='fu'>e_to_afl</span><span class='op'>(</span><span class='va'>e</span>, regex_func <span class='op'>=</span> <span class='st'>"regex"</span>, ignore_case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>e</code></dt><dd><p>A list of R expression(s). If more than one expression is provided,
they will be joined with logic AND.</p></dd>

<dt><code>regex_func</code></dt><dd><p>A string of regex function implementation, default 'regex'.
Due to scidb compatiblity issue with its dependencies, the regex function from boost library may not be available
Currently supported options include 'rsub', and 'regex'</p></dd>

<dt><code>ignore_case</code></dt><dd><p>A Boolean, default TRUE. If TRUE, ignore case in string match patterns.
Otherwise, perform case-sensitive regex matches.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>An AFL filter string</p>
<p><hr>
<a id="method-args_to_expressions"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>args_to_expressions()</code></h3>
<p>Convert API ... args to an R expression vector (deprecated)</p>
<p>Some API functions include ... arg to represent arbitrary search criteria.
This provides flexibility and simplifies API function signatures, but only supports limited advanced search,
e.g. xxx_contains, xxx_range, xxx_not.</p>
<p>Eg. name_contains = 'str' =&gt; name %contains% 'str'
Eg. value_range = c(1, 9) =&gt; c(value &gt;= 1, value &lt;= 9)</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AFLUtils</span><span class='op'>$</span><span class='fu'>args_to_expressions</span><span class='op'>(</span><span class='va'>...</span>, .dots <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>...</code></dt><dd><p>API ellipsis args</p></dd>

<dt><code>.dots</code></dt><dd><p>Explicitly provide a parameter list. If not NULL, the ellipsis params are ignored</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>A list of AFL expressions in R</p>
<p><hr>
<a id="method-e"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>e()</code></h3>
<p>Create a list of R expressions</p>
<p>The ... ellipsis arg can include arbitrary expressions, where all names are preserved in their literal forms,
<strong>except</strong> for those prefixed with !! (double exclamation marks) which will be evaluated to their actual values
in the calling environment.</p>
<p>Besides common comparison operators including <code><a href='https://rdrr.io/r/base/Comparison.html'>==</a></code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code><a href='https://rdrr.io/r/base/Comparison.html'>!=</a></code>, there are a few special operators
supported to ease AFL generation:</p><ul>
<li><p><code><a href='https://rdrr.io/r/base/match.html'>%in%</a></code> semantically similar to R. <code>a %in% !!c(1,2,3)</code> will be translated to <code>(a == 1 or a == 2 or a == 3)</code></p></li>
<li><p><code>%like%</code> for string regex matching.</p></li>
</ul>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AFLUtils</span><span class='op'>$</span><span class='fu'>e</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>...</code></dt><dd><p>The ellipsis arg can have multiple items as expressions, but NO named items as in a named list.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>A list of R expressions</p>
<p><hr>
<a id="method-e_merge"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>e_merge()</code></h3>
<p>Merge multiple R expressions into one</p>
<p>Merge an ExprsList into a single Expression so that it can be used as a FilterExpr</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AFLUtils</span><span class='op'>$</span><span class='fu'>e_merge</span><span class='op'>(</span><span class='va'>el</span>, mode <span class='op'>=</span> <span class='st'>"AND"</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>el</code></dt><dd><p>A list of R expressions</p></dd>

<dt><code>mode</code></dt><dd><p>'AND' | 'OR'. Logical relationships when merging the expressions.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>R expression</p>
<p><hr>
<a id="method-join_fields"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>join_fields()</code></h3>
<p>Just multple fields with sep = ','</p>
<p>Default behavior: <code><a href='https://rdrr.io/r/base/paste.html'>paste(..., sep = sep, collapse = sep)</a></code> where <code>sep = ','</code></p>
<p>afl(...) will convert vectors to joined strings separated by <code>,</code>.
This function is useful in concatenating multiple vectors in parallel,
e.g. joining a new field vector and expression vector for the <code>apply</code> operator.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AFLUtils</span><span class='op'>$</span><span class='fu'>join_fields</span><span class='op'>(</span><span class='va'>...</span>, sep <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>...</code></dt><dd><p>Multiple string vectors</p></dd>

<dt><code>sep</code></dt><dd><p>A single character string, defaullt ",", as field separator.</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-validate_filter_expr"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>validate_filter_expr()</code></h3>
<p>Validate a filter expression</p>
<p>Current only report errors on:</p><ol>
<li><p>Name symbols that are not known schema fields, defined by
param <code>all_fields</code></p></li>
<li><p>Non-atomic R 'values' in the expression</p></li>
</ol>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>AFLUtils</span><span class='op'>$</span><span class='fu'>validate_filter_expr</span><span class='op'>(</span><span class='va'>filter_expr</span>, <span class='va'>all_fields</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>filter_expr</code></dt><dd><p>AFL captured as a single R expression</p></dd>

<dt><code>all_fields</code></dt><dd><p>A list of strings as the scope of valid fields</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>A list object with named elements:
success:bool, absent_fields: c(''), error_msgs: c('')</p>



  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by  Paradigm4.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



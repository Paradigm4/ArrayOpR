<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get Started • arrayop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get Started">
<meta property="og:description" content="arrayop">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">arrayop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/arrayop.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/semi_join.html">Semi Join</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Paradigm4/ArrayOpR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="arrayop_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="arrayop_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="arrayop_files/pagedtable-1.1/js/pagedtable.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get Started</h1>
                        <h4 class="author">Paradigm4</h4>
            
            <h4 class="date">2020-09-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Paradigm4/ArrayOpR/blob/master/vignettes/arrayop.Rmd"><code>vignettes/arrayop.Rmd</code></a></small>
      <div class="hidden name"><code>arrayop.Rmd</code></div>

    </div>

    
    
<div id="connect-to-scidb" class="section level1">
<h1 class="hasAnchor">
<a href="#connect-to-scidb" class="anchor"></a>Connect to SciDB</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">arrayop</span>) <span class="co"># optional step to leave out the `arrayop::` prefix.</span>
<span class="co"># First, load user name and token from an authentication file, which is also compatible with iquery.</span>
<span class="no">auth</span> <span class="kw">=</span> <span class="kw pkg">yaml</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/yaml.load.html">yaml.load_file</a></span>(<span class="st">"~/.scidb_auth"</span>)
<span class="co"># Then connect to scidb. Params host, username and token are all single strings and can be provided in any way</span>
<span class="no">conn</span> <span class="kw">=</span> <span class="fu"><a href="../reference/db_connect.html">db_connect</a></span>(<span class="kw">host</span> <span class="kw">=</span> <span class="st">"localhost"</span>, <span class="kw">username</span> <span class="kw">=</span> <span class="no">auth</span><span class="kw">[[</span><span class="st">"user-name"</span>]], <span class="kw">token</span> <span class="kw">=</span> <span class="no">auth</span><span class="kw">[[</span><span class="st">"user-password"</span>]])</pre></body></html></div>
<p>Once we have connected to scidb with <code>db_connect</code>, we can get save the connection instance as shown above. Or call <code><a href="../reference/get_default_connection.html">arrayop::get_default_connection()</a></code> anywhere in code, which always return the db connection.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="fu"><a href="../reference/get_default_connection.html">get_default_connection</a></span>(), <span class="no">conn</span>) <span class="co"># the exact same thing!</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">conn</span>) <span class="co"># print out `username@host [scidb version]` if the connection is succesful</span>
<span class="co">#&gt; ScidbConnection: scidbadmin@localhost [19.11.5]</span></pre></body></html></div>
</div>
<div id="get-array_op-instances" class="section level1">
<h1 class="hasAnchor">
<a href="#get-array_op-instances" class="anchor"></a>Get array_op instances</h1>
<p>We use the term <code>array_op</code> to denote two types of arrays:</p>
<ol style="list-style-type: decimal">
<li>persistent arrays in SciDB, denoted by an array name, e.g. <code>myNamespace.myArray</code>.</li>
<li>array operations, ie. any numbers of potentially nested operations on one or multiple arrays. E.g. filter on one array; or join two arrays then filter the joined.</li>
</ol>
<p>Semantically, both types of arrays are the same, and support the same <a href="%60ArrayOpBase%60">set of verbs</a>. They also both have:</p>
<ol style="list-style-type: decimal">
<li>one or more attributes</li>
<li>zero or more dimensions</li>
</ol>
<p>Regular arrays have at least one explicit dimensions. SciDB data frames have no explit dimension, but internally two hidden dimensions whose names starts with a dollar sign $.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Upload a data frame to scidb</span>
<span class="no">arr_uploaded</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">upload_df</span>(<span class="no">CO2</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"test_CO2"</span>) <span class="co"># datasets::CO2</span>

<span class="co"># Or just create a new array</span>
<span class="no">arr_created</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">create_array</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"test_CO2_empty"</span>,
  <span class="kw">schema_template</span> <span class="kw">=</span> <span class="st">"&lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [i]"</span>
)
<span class="co"># Create a scidb data frame. Notice no dimension provided</span>
<span class="no">arr_created_df</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">create_array</span>(
  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"test_CO2_empty_df"</span>,
  <span class="kw">schema_template</span> <span class="kw">=</span> <span class="st">"&lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt;"</span> <span class="co"># leave out any dimension</span>
)

<span class="co"># Retrieve an existing array (the one we just uploaded)</span>
<span class="no">arr_existing</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="st">"test_CO2"</span>)

<span class="co"># Compile data.frame into a scidb 'build' operation with a build dimension</span>
<span class="no">arr_compiled</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">compile_df</span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">CO2</span>,<span class="fl">4</span>))
<span class="co"># Compile to a scidb data frame without explicit dimensions</span>
<span class="no">arr_compiled_df</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">compile_df</span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">CO2</span>,<span class="fl">4</span>), <span class="kw">as_scidb_data_frame</span> <span class="kw">=</span> <span class="no">T</span>)

<span class="co"># Create a transient array by AFL</span>
<span class="no">arr_from_afl</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">afl_expr</span>(<span class="no">arr_existing</span>$<span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">conc</span> <span class="kw">&gt;</span> <span class="fl">800</span>)$<span class="fu">to_afl</span>())

<span class="co"># Store an AFL statement into a persistent array</span>
<span class="no">arr_stored</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">afl_expr</span>(
    <span class="co"># afl_str = "filter(test_CO2, conc &gt; 800)" # equivalent to code below</span>
    <span class="no">arr_existing</span>$<span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">conc</span> <span class="kw">&gt;</span> <span class="fl">800</span>)$<span class="fu">to_afl</span>()
  )$<span class="fu">persist</span>(
    <span class="kw">save_array_name</span> <span class="kw">=</span> <span class="st">"test_CO2_stored"</span>, <span class="kw">.gc</span> <span class="kw">=</span> <span class="no">F</span> <span class="co"># prevent from being destroyed by R's garbage collected</span>
  )</pre></body></html></div>
<p>Let’s inspect these arrays!</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">arr_uploaded</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "test_CO2"</span>
<span class="no">arr_uploaded</span>$<span class="fu">to_schema_str</span>()
<span class="co">#&gt; [1] "&lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [i=1:84:0:10000]"</span>
<span class="no">arr_uploaded</span>$<span class="fu">is_persistent</span>() <span class="co"># test if the afl is an array name, without checking in db</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="no">arr_uploaded</span>$<span class="fu">exists_persistent_array</span>() <span class="co"># whether the persistent array exists in db (does check in db)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="no">arr_uploaded</span>$<span class="fu">array_meta_data</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["uaid"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["aid"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["schema"],"name":[4],"type":["chr"],"align":["left"]},{"label":["availability"],"name":[5],"type":["lgl"],"align":["right"]},{"label":["temporary"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["namespace"],"name":[7],"type":["chr"],"align":["left"]},{"label":["distribution"],"name":[8],"type":["chr"],"align":["left"]},{"label":["etcomp"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"test_CO2","2":"118793","3":"118794","4":"test_CO2<Plant:string,Type:string,Treatment:string,conc:double,uptake:double> [i=1:84:0:10000]","5":"TRUE","6":"FALSE","7":"public","8":"hashed","9":"none"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">arr_uploaded</span>$<span class="fu">summarize_array</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["inst"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["attid"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["att"],"name":[3],"type":["chr"],"align":["left"]},{"label":["count"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bytes"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["chunks"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["min_count"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["avg_count"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["max_count"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["min_bytes"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["avg_bytes"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["max_bytes"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"all","4":"84","5":"2135","6":"6","7":"84","8":"84","9":"84","10":"48","11":"355.8333","12":"752"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">arr_uploaded</span>$<span class="fu">cell_count</span>()
<span class="co">#&gt; [1] 84</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">arr_created</span>)
<span class="co">#&gt; [1] "test_CO2_empty &lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [i=0:*:0:*]"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">arr_existing</span>) <span class="co"># same as arr_uploaded</span>
<span class="co">#&gt; [1] "test_CO2 &lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [i=1:84:0:10000]"</span>

<span class="no">arr_compiled</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "build(&lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt;[IPdbhdJbar_], '[(\\'Qn1\\',\\'Quebec\\',\\'nonchilled\\',95,16),(\\'Qn1\\',\\'Quebec\\',\\'nonchilled\\',175,30.4),(\\'Qn1\\',\\'Quebec\\',\\'nonchilled\\',250,34.8),(\\'Qn1\\',\\'Quebec\\',\\'nonchilled\\',350,37.2)]', true)"</span>
<span class="no">arr_compiled</span>$<span class="fu">to_schema_str</span>()
<span class="co">#&gt; [1] "&lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [IPdbhdJbar_=0:*:0:100000]"</span>
<span class="no">arr_compiled</span>$<span class="fu">is_persistent</span>()
<span class="co">#&gt; [1] FALSE</span>

<span class="co"># SciDB data frames</span>
<span class="no">arr_created_df</span>$<span class="fu">to_schema_str</span>()
<span class="co">#&gt; [1] "&lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [$inst=0:*:0:1;$seq=0:*:0:*]"</span>
<span class="no">arr_compiled_df</span>$<span class="fu">to_schema_str</span>()
<span class="co">#&gt; [1] "&lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [$inst=0:*:0:1;$seq=0:*:0:100000]"</span>

<span class="no">arr_from_afl</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "filter(test_CO2,conc &gt; 800)"</span>
<span class="no">arr_from_afl</span>$<span class="fu">cell_count</span>()
<span class="co">#&gt; [1] 12</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">arr_stored</span>)
<span class="co">#&gt; [1] "test_CO2_stored &lt;Plant:string,Type:string,Treatment:string,conc:double,uptake:double&gt; [i=1:84:0:10000]"</span>
<span class="no">arr_stored</span>$<span class="fu">cell_count</span>()
<span class="co">#&gt; [1] 12</span></pre></body></html></div>
</div>
<div id="download-array_op-as-data-frame" class="section level1">
<h1 class="hasAnchor">
<a href="#download-array_op-as-data-frame" class="anchor"></a>Download array_op as data.frame</h1>
<p>Call <code>to_df</code> method on any <code>array_op</code> instance to get a data frame with all its attributes; or <code>to_df_all</code> to get all fields (both dimensions and attributes).</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">arr_stored</span>$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"Quebec","3":"nonchilled","4":"1000","5":"39.7"},{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"1000","5":"44.3"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"1000","5":"45.5"},{"1":"Qc1","2":"Quebec","3":"chilled","4":"1000","5":"38.7"},{"1":"Qc2","2":"Quebec","3":"chilled","4":"1000","5":"42.4"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"1000","5":"41.4"},{"1":"Mn1","2":"Mississippi","3":"nonchilled","4":"1000","5":"35.5"},{"1":"Mn2","2":"Mississippi","3":"nonchilled","4":"1000","5":"31.5"},{"1":"Mn3","2":"Mississippi","3":"nonchilled","4":"1000","5":"27.8"},{"1":"Mc1","2":"Mississippi","3":"chilled","4":"1000","5":"21.9"},{"1":"Mc2","2":"Mississippi","3":"chilled","4":"1000","5":"14.4"},{"1":"Mc3","2":"Mississippi","3":"chilled","4":"1000","5":"19.9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">arr_stored</span>$<span class="fu">to_df_all</span>() <span class="co"># Notice the dimension column [i]</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["i"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Plant"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[4],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"7","2":"Qn1","3":"Quebec","4":"nonchilled","5":"1000","6":"39.7"},{"1":"14","2":"Qn2","3":"Quebec","4":"nonchilled","5":"1000","6":"44.3"},{"1":"21","2":"Qn3","3":"Quebec","4":"nonchilled","5":"1000","6":"45.5"},{"1":"28","2":"Qc1","3":"Quebec","4":"chilled","5":"1000","6":"38.7"},{"1":"35","2":"Qc2","3":"Quebec","4":"chilled","5":"1000","6":"42.4"},{"1":"42","2":"Qc3","3":"Quebec","4":"chilled","5":"1000","6":"41.4"},{"1":"49","2":"Mn1","3":"Mississippi","4":"nonchilled","5":"1000","6":"35.5"},{"1":"56","2":"Mn2","3":"Mississippi","4":"nonchilled","5":"1000","6":"31.5"},{"1":"63","2":"Mn3","3":"Mississippi","4":"nonchilled","5":"1000","6":"27.8"},{"1":"70","2":"Mc1","3":"Mississippi","4":"chilled","5":"1000","6":"21.9"},{"1":"77","2":"Mc2","3":"Mississippi","4":"chilled","5":"1000","6":"14.4"},{"1":"84","2":"Mc3","3":"Mississippi","4":"chilled","5":"1000","6":"19.9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong>Common array operations</strong></p>
<p>We can create array_ops on the fly and download them as data frames. Each array operation also returns an array_op instance. So we can chain up the operations in a <code>dplyr</code> like data flow. All the array operation verbs are named following <code>dplyr</code> convention where appropriate, e.g. <code>filter</code>, <code>inner_join</code>, <code>mutate</code>, <code>group_by</code> and <code>summarize</code> etc.</p>
</div>
<div id="filter" class="section level1">
<h1 class="hasAnchor">
<a href="#filter" class="anchor"></a>Filter</h1>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># Comma separated expressions are joined with logical AND</span>
<span class="no">arr_existing</span>$<span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">conc</span> <span class="kw">&gt;</span> <span class="fl">80</span>, <span class="no">uptake</span> <span class="kw">&gt;</span> <span class="fl">40</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"350","5":"41.8"},{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"500","5":"40.6"},{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"675","5":"41.4"},{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"1000","5":"44.3"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"250","5":"40.3"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"350","5":"42.1"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"500","5":"42.9"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"675","5":"43.9"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"1000","5":"45.5"},{"1":"Qc2","2":"Quebec","3":"chilled","4":"1000","5":"42.4"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"1000","5":"41.4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># Equivalent to above</span>
<span class="co"># arr_existing$filter(conc &gt; 80 &amp; uptake &gt; 40)$to_df()</span>

<span class="no">arr_existing</span>$<span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">conc</span> <span class="kw">&lt;=</span> <span class="fl">100</span> <span class="kw">|</span> <span class="no">conc</span> <span class="kw">&gt;</span> <span class="fl">900</span>)$<span class="fu">to_df</span>() <span class="co"># logical OR</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"Quebec","3":"nonchilled","4":"95","5":"16.0"},{"1":"Qn1","2":"Quebec","3":"nonchilled","4":"1000","5":"39.7"},{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"95","5":"13.6"},{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"1000","5":"44.3"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"95","5":"16.2"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"1000","5":"45.5"},{"1":"Qc1","2":"Quebec","3":"chilled","4":"95","5":"14.2"},{"1":"Qc1","2":"Quebec","3":"chilled","4":"1000","5":"38.7"},{"1":"Qc2","2":"Quebec","3":"chilled","4":"95","5":"9.3"},{"1":"Qc2","2":"Quebec","3":"chilled","4":"1000","5":"42.4"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"95","5":"15.1"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"1000","5":"41.4"},{"1":"Mn1","2":"Mississippi","3":"nonchilled","4":"95","5":"10.6"},{"1":"Mn1","2":"Mississippi","3":"nonchilled","4":"1000","5":"35.5"},{"1":"Mn2","2":"Mississippi","3":"nonchilled","4":"95","5":"12.0"},{"1":"Mn2","2":"Mississippi","3":"nonchilled","4":"1000","5":"31.5"},{"1":"Mn3","2":"Mississippi","3":"nonchilled","4":"95","5":"11.3"},{"1":"Mn3","2":"Mississippi","3":"nonchilled","4":"1000","5":"27.8"},{"1":"Mc1","2":"Mississippi","3":"chilled","4":"95","5":"10.5"},{"1":"Mc1","2":"Mississippi","3":"chilled","4":"1000","5":"21.9"},{"1":"Mc2","2":"Mississippi","3":"chilled","4":"95","5":"7.7"},{"1":"Mc2","2":"Mississippi","3":"chilled","4":"1000","5":"14.4"},{"1":"Mc3","2":"Mississippi","3":"chilled","4":"95","5":"10.6"},{"1":"Mc3","2":"Mississippi","3":"chilled","4":"1000","5":"19.9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb11"><html><body><pre class="r">
<span class="co"># Filter on string fields</span>
<span class="co"># %like% takes regex as the right operand; all other verbs treat strings literally.</span>
<span class="no">arr_existing</span>$<span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">Plant</span> <span class="kw">%contains%</span> <span class="st">"3"</span>, <span class="no">Plant</span> <span class="kw">%starts_with%</span> <span class="st">"Q"</span>, <span class="no">Treatment</span> <span class="kw">%contains%</span> <span class="st">"chill"</span>, <span class="no">Treatment</span> <span class="kw">%like%</span> <span class="st">"chill[a-z]{2}$"</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qc3","2":"Quebec","3":"chilled","4":"95","5":"15.1"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"175","5":"21.0"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"250","5":"38.1"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"350","5":"34.0"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"500","5":"38.9"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"675","5":"39.6"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"1000","5":"41.4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="mutatetransmute" class="section level1">
<h1 class="hasAnchor">
<a href="#mutatetransmute" class="anchor"></a>Mutate/Transmute</h1>
<div id="by-expressions" class="section level2">
<h2 class="hasAnchor">
<a href="#by-expressions" class="anchor"></a>By expressions</h2>
<p>As shown below, field names can be either quoted or not quoted. But the field expression must be a single string. Unlike R, SciDB uses single quotes for string literals. E.g. <code>'at'</code> is single-quoted.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># Modify existing fields</span>
<span class="no">result</span> <span class="kw">=</span> <span class="no">arr_stored</span>$<span class="fu">mutate</span>(<span class="kw">Type</span> <span class="kw">=</span> <span class="st">'at_'</span> + <span class="no">Type</span>, <span class="kw">conc</span> <span class="kw">=</span> <span class="no">conc</span>/<span class="fl">1000</span>)
<span class="no">result</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "project(apply(project(apply(test_CO2_stored,_Type,'at_' + Type,_conc,conc / 1000),_Type,_conc,Plant,Treatment,uptake),Type,_Type,conc,_conc),Plant,Type,Treatment,conc,uptake)"</span>
<span class="no">result</span>$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"at_Quebec","3":"nonchilled","4":"1","5":"39.7"},{"1":"Qn2","2":"at_Quebec","3":"nonchilled","4":"1","5":"44.3"},{"1":"Qn3","2":"at_Quebec","3":"nonchilled","4":"1","5":"45.5"},{"1":"Qc1","2":"at_Quebec","3":"chilled","4":"1","5":"38.7"},{"1":"Qc2","2":"at_Quebec","3":"chilled","4":"1","5":"42.4"},{"1":"Qc3","2":"at_Quebec","3":"chilled","4":"1","5":"41.4"},{"1":"Mn1","2":"at_Mississippi","3":"nonchilled","4":"1","5":"35.5"},{"1":"Mn2","2":"at_Mississippi","3":"nonchilled","4":"1","5":"31.5"},{"1":"Mn3","2":"at_Mississippi","3":"nonchilled","4":"1","5":"27.8"},{"1":"Mc1","2":"at_Mississippi","3":"chilled","4":"1","5":"21.9"},{"1":"Mc2","2":"at_Mississippi","3":"chilled","4":"1","5":"14.4"},{"1":"Mc3","2":"at_Mississippi","3":"chilled","4":"1","5":"19.9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb13"><html><body><pre class="r">
<span class="co"># Add new fields</span>
<span class="no">result</span> <span class="kw">=</span> <span class="no">arr_stored</span>$<span class="fu">mutate</span>(<span class="kw">Plant_Type</span> <span class="kw">=</span> <span class="no">Plant</span> + <span class="st">'-'</span> + <span class="no">Type</span>, <span class="kw">feel</span> <span class="kw">=</span> <span class="kw">if</span>(<span class="no">Treatment</span> <span class="kw">==</span> <span class="st">'chilled'</span>) <span class="st">'cold'</span> <span class="kw">else</span> <span class="st">'ok'</span>)

<span class="co"># Same as above. Notice the `iif` operator is explicitly written here, </span>
<span class="co"># equivalent to native R `if` statement</span>
<span class="co"># result = arr_stored$mutate(Plant_Type = Plant + '-' + Type, feel = iif(Treatment == 'chilled', 'cold', 'ok'))</span>
<span class="no">result</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "project(apply(test_CO2_stored,Plant_Type,Plant + '-' + Type,feel,iif(Treatment = 'chilled','cold','ok')),Plant,Type,Treatment,conc,uptake,Plant_Type,feel)"</span>
<span class="no">result</span>$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Plant_Type"],"name":[6],"type":["chr"],"align":["left"]},{"label":["feel"],"name":[7],"type":["chr"],"align":["left"]}],"data":[{"1":"Qn1","2":"Quebec","3":"nonchilled","4":"1000","5":"39.7","6":"Qn1-Quebec","7":"ok"},{"1":"Qn2","2":"Quebec","3":"nonchilled","4":"1000","5":"44.3","6":"Qn2-Quebec","7":"ok"},{"1":"Qn3","2":"Quebec","3":"nonchilled","4":"1000","5":"45.5","6":"Qn3-Quebec","7":"ok"},{"1":"Qc1","2":"Quebec","3":"chilled","4":"1000","5":"38.7","6":"Qc1-Quebec","7":"cold"},{"1":"Qc2","2":"Quebec","3":"chilled","4":"1000","5":"42.4","6":"Qc2-Quebec","7":"cold"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"1000","5":"41.4","6":"Qc3-Quebec","7":"cold"},{"1":"Mn1","2":"Mississippi","3":"nonchilled","4":"1000","5":"35.5","6":"Mn1-Mississippi","7":"ok"},{"1":"Mn2","2":"Mississippi","3":"nonchilled","4":"1000","5":"31.5","6":"Mn2-Mississippi","7":"ok"},{"1":"Mn3","2":"Mississippi","3":"nonchilled","4":"1000","5":"27.8","6":"Mn3-Mississippi","7":"ok"},{"1":"Mc1","2":"Mississippi","3":"chilled","4":"1000","5":"21.9","6":"Mc1-Mississippi","7":"cold"},{"1":"Mc2","2":"Mississippi","3":"chilled","4":"1000","5":"14.4","6":"Mc2-Mississippi","7":"cold"},{"1":"Mc3","2":"Mississippi","3":"chilled","4":"1000","5":"19.9","6":"Mc3-Mississippi","7":"cold"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code>mutate</code> operation keeps the original fields unless we modify them.</p>
<p><code>transmute</code> allows us to explicitly specify which fields to keep.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># strings are escaped for AFL </span>
<span class="no">result</span> <span class="kw">=</span> <span class="no">arr_stored</span>$<span class="fu">transmute</span>(<span class="no">Plant</span>, <span class="kw">Plant_Type</span> <span class="kw">=</span> <span class="no">Plant</span> + <span class="st">"'-'"</span> + <span class="no">Type</span>, <span class="kw">feel</span> <span class="kw">=</span> <span class="fu">iif</span>(<span class="no">Treatment</span> <span class="kw">==</span> <span class="st">'chilled'</span>, <span class="st">'c"ooo"ld'</span>, <span class="st">"OK"</span>))
<span class="no">result</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "project(apply(test_CO2_stored,Plant_Type,Plant + '\\'-\\'' + Type,feel,iif(Treatment = 'chilled','c\"ooo\"ld','OK')),Plant,Plant_Type,feel)"</span>
<span class="no">result</span>$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Plant_Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["feel"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Qn1","2":"Qn1'-'Quebec","3":"OK"},{"1":"Qn2","2":"Qn2'-'Quebec","3":"OK"},{"1":"Qn3","2":"Qn3'-'Quebec","3":"OK"},{"1":"Qc1","2":"Qc1'-'Quebec","3":"c\"ooo\"ld"},{"1":"Qc2","2":"Qc2'-'Quebec","3":"c\"ooo\"ld"},{"1":"Qc3","2":"Qc3'-'Quebec","3":"c\"ooo\"ld"},{"1":"Mn1","2":"Mn1'-'Mississippi","3":"OK"},{"1":"Mn2","2":"Mn2'-'Mississippi","3":"OK"},{"1":"Mn3","2":"Mn3'-'Mississippi","3":"OK"},{"1":"Mc1","2":"Mc1'-'Mississippi","3":"c\"ooo\"ld"},{"1":"Mc2","2":"Mc2'-'Mississippi","3":"c\"ooo\"ld"},{"1":"Mc3","2":"Mc3'-'Mississippi","3":"c\"ooo\"ld"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="by-arrays" class="section level2">
<h2 class="hasAnchor">
<a href="#by-arrays" class="anchor"></a>By arrays</h2>
<p><code>mutate</code> and <code>transmute</code> are useful if the mutated fields are in expressions. Another common use case is mutating fields of an existing array by another array, rather than by expressions.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">dataArray</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">array_from_df</span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Plant</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Qn1"</span>, <span class="st">"Qn2"</span>, <span class="st">"Qn3"</span>), <span class="kw">Treatment</span> <span class="kw">=</span> <span class="st">"treated-mutated"</span>))
<span class="no">result</span> <span class="kw">=</span> <span class="no">arr_stored</span>$<span class="fu">mutate_by</span>(<span class="no">dataArray</span>, <span class="kw">keys</span> <span class="kw">=</span> <span class="st">"Plant"</span>, <span class="kw">updated_fields</span> <span class="kw">=</span> <span class="st">"Treatment"</span>)
<span class="no">result</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "project(join(project(redimension(project(equi_join(project(build(&lt;Plant:string,Treatment:string&gt;[DDEi_], '[(\\'Qn1\\',\\'treated-mutated\\'),(\\'Qn2\\',\\'treated-mutated\\'),(\\'Qn3\\',\\'treated-mutated\\')]', true),Treatment,Plant) as _L, project(apply(test_CO2_stored,i,i),i,Plant) as _R, left_names:_L.Plant, right_names:_R.Plant),Treatment,i),&lt;Treatment:string&gt; [i=1:84:0:10000]),Treatment),project(test_CO2_stored,Plant,Type,conc,uptake)),Plant,Type,Treatment,conc,uptake)"</span>
<span class="no">result</span>$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"Quebec","3":"treated-mutated","4":"1000","5":"39.7"},{"1":"Qn2","2":"Quebec","3":"treated-mutated","4":"1000","5":"44.3"},{"1":"Qn3","2":"Quebec","3":"treated-mutated","4":"1000","5":"45.5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="array-mutability" class="section level1">
<h1 class="hasAnchor">
<a href="#array-mutability" class="anchor"></a>Array Mutability</h1>
<p><strong>NOTE</strong>: the source arrays remain the same in examples above. All mutate operations just created <strong>mutated data copies</strong> of the source.</p>
<p>To modify array content, we can <code>update</code> or <code>overwrite</code> the source array with <strong>mutated data copies</strong>.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">dataArray</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">array_from_df</span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Plant</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Qn1"</span>, <span class="st">"Qn2"</span>, <span class="st">"Qn3"</span>), <span class="kw">Treatment</span> <span class="kw">=</span> <span class="st">"treated-mutated"</span>))
<span class="no">mutated</span> <span class="kw">=</span> <span class="no">arr_stored</span>$<span class="fu">mutate_by</span>(<span class="no">dataArray</span>, <span class="kw">keys</span> <span class="kw">=</span> <span class="st">"Plant"</span>, <span class="kw">updated_fields</span> <span class="kw">=</span> <span class="st">"Treatment"</span>)

<span class="co"># Persist data changes to an existing array</span>
<span class="no">mutated</span>$<span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="no">arr_stored</span>)$<span class="fu">execute</span>()
<span class="no">arr_stored</span>$<span class="fu">to_df</span>() <span class="co"># Only matched data cells are updated</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"Quebec","3":"treated-mutated","4":"1000","5":"39.7"},{"1":"Qn2","2":"Quebec","3":"treated-mutated","4":"1000","5":"44.3"},{"1":"Qn3","2":"Quebec","3":"treated-mutated","4":"1000","5":"45.5"},{"1":"Qc1","2":"Quebec","3":"chilled","4":"1000","5":"38.7"},{"1":"Qc2","2":"Quebec","3":"chilled","4":"1000","5":"42.4"},{"1":"Qc3","2":"Quebec","3":"chilled","4":"1000","5":"41.4"},{"1":"Mn1","2":"Mississippi","3":"nonchilled","4":"1000","5":"35.5"},{"1":"Mn2","2":"Mississippi","3":"nonchilled","4":"1000","5":"31.5"},{"1":"Mn3","2":"Mississippi","3":"nonchilled","4":"1000","5":"27.8"},{"1":"Mc1","2":"Mississippi","3":"chilled","4":"1000","5":"21.9"},{"1":"Mc2","2":"Mississippi","3":"chilled","4":"1000","5":"14.4"},{"1":"Mc3","2":"Mississippi","3":"chilled","4":"1000","5":"19.9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb17"><html><body><pre class="r">
<span class="no">mutated</span>$<span class="fu">overwrite</span>(<span class="no">arr_stored</span>)$<span class="fu">execute</span>()
<span class="no">arr_stored</span>$<span class="fu">to_df</span>() <span class="co"># Caution: Overwrite all array content!!!</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Treatment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["conc"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["uptake"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"Quebec","3":"treated-mutated","4":"1000","5":"39.7"},{"1":"Qn2","2":"Quebec","3":"treated-mutated","4":"1000","5":"44.3"},{"1":"Qn3","2":"Quebec","3":"treated-mutated","4":"1000","5":"45.5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="join" class="section level1">
<h1 class="hasAnchor">
<a href="#join" class="anchor"></a>Join</h1>
<p>Three joins are supported: <code>inner_join</code>, <code>left_join</code> and <code>right_join</code>.</p>
<p>First, let’s populate two arrays.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">leftDf</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">lda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">5</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="fl">11</span>:<span class="fl">15</span>, <span class="kw">fa</span> <span class="kw">=</span> <span class="no">LETTERS</span>[<span class="fl">1</span>:<span class="fl">5</span>],  <span class="kw">lfb</span> <span class="kw">=</span> <span class="fl">3.14</span> * <span class="fl">1</span>:<span class="fl">5</span>)
<span class="no">rightDf</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">rda</span> <span class="kw">=</span> <span class="fl">3</span>:<span class="fl">10</span>, <span class="kw">db</span> <span class="kw">=</span> <span class="fl">13</span>:<span class="fl">20</span>, <span class="kw">fa</span> <span class="kw">=</span> <span class="no">LETTERS</span>[<span class="fl">3</span>:<span class="fl">10</span>], <span class="kw">rfb</span> <span class="kw">=</span> <span class="fl">3.14</span> * <span class="fl">3</span>:<span class="fl">10</span>)

<span class="no">leftDf</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["int"],"align":["right"]},{"label":["db"],"name":[2],"type":["int"],"align":["right"]},{"label":["fa"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"11","3":"A","4":"3.14"},{"1":"2","2":"12","3":"B","4":"6.28"},{"1":"3","2":"13","3":"C","4":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">rightDf</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rda"],"name":[1],"type":["int"],"align":["right"]},{"label":["db"],"name":[2],"type":["int"],"align":["right"]},{"label":["fa"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["rfb"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"13","3":"C","4":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70"},{"1":"6","2":"16","3":"F","4":"18.84"},{"1":"7","2":"17","3":"G","4":"21.98"},{"1":"8","2":"18","3":"H","4":"25.12"},{"1":"9","2":"19","3":"I","4":"28.26"},{"1":"10","2":"20","3":"J","4":"31.40"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb20"><html><body><pre class="r">
<span class="co"># At least one input to 'cross_join' must have a specified chunk size.</span>
<span class="co"># So we need to persist the arrays</span>
<span class="no">L</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">array_from_df</span>(<span class="no">leftDf</span>, <span class="st">"&lt;fa:string, lfb:double&gt; [lda;db] "</span>, <span class="kw">force_template_schema</span> <span class="kw">=</span> <span class="no">T</span>)$<span class="fu">persist</span>(<span class="kw">.gc</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">R</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">array_from_df</span>(<span class="no">rightDf</span>, <span class="st">"&lt;fa:string, rfb:double&gt; [rda;db] "</span>, <span class="kw">force_template_schema</span> <span class="kw">=</span> <span class="no">T</span>)$<span class="fu">persist</span>(<span class="kw">.gc</span> <span class="kw">=</span> <span class="no">F</span>)</pre></body></html></div>
<p>Then, start with a vinilla join where join keys are inferred from array fields. In this case, <code>fa</code> and <code>db</code> are join keys since they exist in both arrays.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">L</span>$<span class="fu">inner_join</span>(<span class="no">R</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rda"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rfb"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"13","3":"C","4":"9.42","5":"3","6":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56","5":"4","6":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"5","6":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">L</span>$<span class="fu">left_join</span>(<span class="no">R</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rda"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rfb"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"12","3":"B","4":"6.28","5":"NA","6":"NA"},{"1":"3","2":"13","3":"C","4":"9.42","5":"3","6":"9.42"},{"1":"1","2":"11","3":"A","4":"3.14","5":"NA","6":"NA"},{"1":"4","2":"14","3":"D","4":"12.56","5":"4","6":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"5","6":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">L</span>$<span class="fu">right_join</span>(<span class="no">R</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rda"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rfb"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"18","3":"H","4":"NA","5":"8","6":"25.12"},{"1":"NA","2":"19","3":"I","4":"NA","5":"9","6":"28.26"},{"1":"NA","2":"20","3":"J","4":"NA","5":"10","6":"31.40"},{"1":"3","2":"13","3":"C","4":"9.42","5":"3","6":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56","5":"4","6":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"5","6":"15.70"},{"1":"NA","2":"16","3":"F","4":"NA","5":"6","6":"18.84"},{"1":"NA","2":"17","3":"G","4":"NA","5":"7","6":"21.98"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We can specify which fields to keep with <code>array_op$select</code>. By default, all fields are selected, except that the join keys only exist once in the result even if they are selected on both operands.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">L</span>$<span class="fu">select</span>(<span class="st">"lfb"</span>, <span class="st">"lda"</span>)$
  <span class="fu">inner_join</span>(<span class="no">R</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lfb"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["lda"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["rda"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["rfb"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"9.42","2":"3","3":"3","4":"9.42"},{"1":"12.56","2":"4","3":"4","4":"12.56"},{"1":"15.70","2":"5","3":"5","4":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb25"><html><body><pre class="r">
<span class="no">L</span>$<span class="fu">inner_join</span>(<span class="no">R</span>$<span class="fu">select</span>(<span class="st">"rda"</span>, <span class="st">"rfb"</span>))$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rda"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rfb"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"13","3":"C","4":"9.42","5":"3","6":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56","5":"4","6":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"5","6":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb26"><html><body><pre class="r">
<span class="no">L</span>$<span class="fu">select</span>(<span class="st">"lfb"</span>, <span class="st">"db"</span>)$<span class="fu">inner_join</span>(<span class="no">R</span>$<span class="fu">select</span>(<span class="st">"rfb"</span>))$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lfb"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["rfb"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"9.42","2":"13","3":"9.42"},{"1":"12.56","2":"14","3":"12.56"},{"1":"15.70","2":"15","3":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We can specify the join keys and aliases explicitly. Array aliases are important to disambiguate overlapping fields.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># `db` as join key, `fa` exists in both arrays and will be suffixed with array aliaes in the result</span>
<span class="no">L</span>$<span class="fu">left_join</span>(<span class="no">R</span>, <span class="kw">on_both</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'db'</span>), <span class="kw">left_alias</span> <span class="kw">=</span> <span class="st">"_LL"</span>, <span class="kw">right_alias</span> <span class="kw">=</span> <span class="st">"_RR"</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa_LL"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rda"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["fa_RR"],"name":[6],"type":["chr"],"align":["left"]},{"label":["rfb"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"12","3":"B","4":"6.28","5":"NA","6":"NA","7":"NA"},{"1":"3","2":"13","3":"C","4":"9.42","5":"3","6":"C","7":"9.42"},{"1":"1","2":"11","3":"A","4":"3.14","5":"NA","6":"NA","7":"NA"},{"1":"4","2":"14","3":"D","4":"12.56","5":"4","6":"D","7":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"5","6":"E","7":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb28"><html><body><pre class="r">
<span class="co"># different join keys</span>
<span class="no">L</span>$<span class="fu">right_join</span>(<span class="no">R</span>, <span class="kw">on_left</span> <span class="kw">=</span> <span class="st">"lda"</span>, <span class="kw">on_right</span> <span class="kw">=</span> <span class="st">"rda"</span>, <span class="kw">left_alias</span> <span class="kw">=</span> <span class="st">"_LL"</span>, <span class="kw">right_alias</span> <span class="kw">=</span> <span class="st">"_RR"</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db_LL"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa_LL"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["db_RR"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["fa_RR"],"name":[6],"type":["chr"],"align":["left"]},{"label":["rfb"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"8","2":"NA","3":"NA","4":"NA","5":"18","6":"H","7":"25.12"},{"1":"9","2":"NA","3":"NA","4":"NA","5":"19","6":"I","7":"28.26"},{"1":"10","2":"NA","3":"NA","4":"NA","5":"20","6":"J","7":"31.40"},{"1":"3","2":"13","3":"C","4":"9.42","5":"13","6":"C","7":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56","5":"14","6":"D","7":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"15","6":"E","7":"15.70"},{"1":"6","2":"NA","3":"NA","4":"NA","5":"16","6":"F","7":"18.84"},{"1":"7","2":"NA","3":"NA","4":"NA","5":"17","6":"G","7":"21.98"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="join-mode" class="section level2">
<h2 class="hasAnchor">
<a href="#join-mode" class="anchor"></a>Join mode</h2>
<p>By default, join is implemented by SciDB <code>equi_join</code> operator, which works great on either array dimensions and/or attributes. But <code>equi_join</code> has one drawback as it materializes results. This can be underiable in a complex nested join.</p>
<p>We can choose a different join mode, <code>cross_join</code>, to avoid result materialization.</p>
<p>Two constraints with <code>cross_join</code> mode:</p>
<ol style="list-style-type: decimal">
<li>join keys must be dimensions on both operands.</li>
<li>only <code>inner_join</code> is supported.</li>
</ol>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">L</span>$<span class="fu">inner_join</span>(<span class="no">R</span>,
             <span class="kw">on_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'db'</span>, <span class="st">'lda'</span>),
             <span class="kw">on_right</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'db'</span>, <span class="st">'rda'</span>),
             <span class="kw">join_mode</span> <span class="kw">=</span> <span class="st">'cross_join'</span>, <span class="kw">left_alias</span> <span class="kw">=</span> <span class="st">"_LL"</span>, <span class="kw">right_alias</span> <span class="kw">=</span> <span class="st">"_RR"</span>)$
  <span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa_LL"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["fa_RR"],"name":[5],"type":["chr"],"align":["left"]},{"label":["rfb"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"13","3":"C","4":"9.42","5":"C","6":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56","5":"D","6":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"E","6":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="custom-settings" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-settings" class="anchor"></a>Custom settings</h2>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">result</span> <span class="kw">=</span> <span class="no">L</span>$<span class="fu">inner_join</span>(<span class="no">R</span>,
             <span class="kw">settings</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
               <span class="kw">algorithm</span> <span class="kw">=</span> <span class="st">"'hash_replicate_right'"</span>, <span class="co"># string setting item</span>
               <span class="kw">hash_join_threshold</span> <span class="kw">=</span> <span class="fl">1024</span> <span class="co"># numeric setting item</span>
         ))
<span class="no">result</span>$<span class="fu">to_afl</span>()
<span class="co">#&gt; [1] "project(equi_join(project(apply(R_array438367c08461600791793371107739,lda,lda),lda,fa,lfb) as _L, project(apply(R_array4384bc441b81600791793371107739,rda,rda),rda,fa,rfb) as _R, left_names:(_L.db,_L.fa), right_names:(_R.db,_R.fa), algorithm:'hash_replicate_right', hash_join_threshold:1024),lda,db,fa,lfb,rda,rfb)"</span>
<span class="no">result</span>$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fa"],"name":[3],"type":["chr"],"align":["left"]},{"label":["lfb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rda"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rfb"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"13","3":"C","4":"9.42","5":"3","6":"9.42"},{"1":"4","2":"14","3":"D","4":"12.56","5":"4","6":"12.56"},{"1":"5","2":"15","3":"E","4":"15.70","5":"5","6":"15.70"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="populate-fields-automatically" class="section level1">
<h1 class="hasAnchor">
<a href="#populate-fields-automatically" class="anchor"></a>Populate fields automatically</h1>
<p>In many SQL dialects, we can define an auto incremented field. When new records are inserted, the field is auto incremented. SciDB currently does not support this feature.</p>
<p>Given a data source array_op (normally created from R data frame or conn$fread), and a target template array which we insert data into, we can acheieve this feature in two steps:</p>
<ol style="list-style-type: decimal">
<li>populate the auto incremented fields of the source array_op using stats from the template target array.</li>
<li>insert the updated source into the target array</li>
</ol>
<p>Let’s see an example. First, create a target array with 3 attrs and 2 dimensions; and a source array with some data. Notice we set the source array’s <code>build_dim_spec = 'z'</code> so that we can refer to it later.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">AutoFieldsContent</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">da</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">db</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">f_str</span> <span class="kw">=</span> <span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">10</span>], <span class="kw">f_int32</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">f_int64</span><span class="kw">=</span><span class="fl">11</span>:<span class="fl">20</span>)
<span class="no">target</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">array_from_df</span>(<span class="no">AutoFieldsContent</span>,
                            <span class="kw">template</span> <span class="kw">=</span> <span class="st">"&lt;f_str:string, f_int32:int32, f_int64:int64&gt; [da=0:*:0:1000; db=0:*:0:1000]"</span>,
                            <span class="kw">force_template_schema</span> <span class="kw">=</span> <span class="no">T</span>)$
              <span class="fu">persist</span>(<span class="kw">.temp</span><span class="kw">=</span><span class="no">T</span>, <span class="kw">.gc</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">empty_target</span> <span class="kw">=</span> <span class="no">conn</span>$<span class="fu">create_array</span>(<span class="no">dbutils</span>$<span class="fu">random_array_name</span>(), <span class="no">target</span>, <span class="kw">.temp</span> <span class="kw">=</span> <span class="no">T</span>)
<span class="no">source</span> <span class="kw">=</span>  <span class="no">conn</span>$<span class="fu">compile_df</span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">f_str</span> <span class="kw">=</span> <span class="no">LETTERS</span>[<span class="fl">1</span>:<span class="fl">3</span>]), <span class="kw">template</span> <span class="kw">=</span> <span class="no">target</span>, <span class="kw">build_dim_spec</span> <span class="kw">=</span> <span class="st">"z"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">source</span>$<span class="fu">set_auto_fields</span>(<span class="no">target</span>)$<span class="fu">to_df</span>() <span class="co"># same as below</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["f_str"],"name":[1],"type":["chr"],"align":["left"]},{"label":["da"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f_int32"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["f_int64"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"11","3":"11","4":"11","5":"21"},{"1":"B","2":"12","3":"12","4":"12","5":"22"},{"1":"C","2":"13","3":"13","4":"13","5":"23"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="co"># source$set_auto_fields(target, source_auto_increment=c(z=0), target_auto_increment=c(da=0, db=0, f_int32=0))$to_df()</span>

<span class="co"># # target_auto_increment does not matter if the target array is not empty</span>
<span class="no">source</span>$<span class="fu">set_auto_fields</span>(<span class="no">target</span>, <span class="kw">source_auto_increment</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">z</span><span class="kw">=</span><span class="fl">0</span>), <span class="kw">target_auto_increment</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">da</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">db</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">f_int32</span><span class="kw">=</span><span class="fl">3</span>))$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["f_str"],"name":[1],"type":["chr"],"align":["left"]},{"label":["da"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f_int32"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"11","3":"11","4":"11"},{"1":"B","2":"12","3":"12","4":"12"},{"1":"C","2":"13","3":"13","4":"13"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb34"><html><body><pre class="r">
<span class="co"># # target_auto_increment affects the initial field values if the target array is empty</span>
<span class="no">source</span>$<span class="fu">set_auto_fields</span>(<span class="no">empty_target</span>, <span class="kw">source_auto_increment</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">z</span><span class="kw">=</span><span class="fl">0</span>), <span class="kw">target_auto_increment</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">da</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">db</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">f_int32</span><span class="kw">=</span><span class="fl">3</span>))$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["f_str"],"name":[1],"type":["chr"],"align":["left"]},{"label":["da"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f_int32"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"1","3":"2","4":"3"},{"1":"B","2":"2","3":"3","4":"4"},{"1":"C","2":"3","3":"4","4":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb35"><html><body><pre class="r">
<span class="co"># By default, both source and target auto increment start from 0</span>
<span class="co"># The only dimension in source is used as the source_auto_increment field; otherwise, we need to specify the source field</span>
<span class="co"># All the missing fields are assumed the target_auto_increment fields unless provided otherwise.</span>
<span class="no">source</span>$<span class="fu">set_auto_fields</span>(<span class="no">empty_target</span>)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["f_str"],"name":[1],"type":["chr"],"align":["left"]},{"label":["da"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f_int32"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["f_int64"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"0","3":"0","4":"0","5":"0"},{"1":"B","2":"1","3":"1","4":"1","5":"1"},{"1":"C","2":"2","3":"2","4":"2","5":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">source</span>$<span class="fu">set_auto_fields</span>(<span class="no">empty_target</span>, <span class="kw">target_auto_increment</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"da"</span>, <span class="st">"db"</span>))$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["f_str"],"name":[1],"type":["chr"],"align":["left"]},{"label":["da"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"0","3":"0"},{"1":"B","2":"1","3":"1"},{"1":"C","2":"2","3":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In a less common case, we may need to populate a dimension field to avoid cell coordinate collisions.</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="no">AutoFieldsContent</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["da"],"name":[1],"type":["int"],"align":["right"]},{"label":["db"],"name":[2],"type":["int"],"align":["right"]},{"label":["f_str"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["f_int32"],"name":[4],"type":["int"],"align":["right"]},{"label":["f_int64"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"a","4":"1","5":"11"},{"1":"2","2":"2","3":"b","4":"2","5":"12"},{"1":"3","2":"3","3":"c","4":"3","5":"13"},{"1":"4","2":"4","3":"d","4":"4","5":"14"},{"1":"5","2":"5","3":"e","4":"5","5":"15"},{"1":"6","2":"6","3":"f","4":"6","5":"16"},{"1":"7","2":"7","3":"g","4":"7","5":"17"},{"1":"8","2":"8","3":"h","4":"8","5":"18"},{"1":"9","2":"9","3":"i","4":"9","5":"19"},{"1":"10","2":"10","3":"j","4":"10","5":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">conn</span>$
    <span class="fu">compile_df</span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">f_str</span> <span class="kw">=</span> <span class="no">LETTERS</span>[<span class="fl">4</span>:<span class="fl">10</span>], <span class="kw">f_int32</span> <span class="kw">=</span> <span class="fl">4</span>:<span class="fl">10</span>, <span class="kw">da</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>)), <span class="kw">template</span> <span class="kw">=</span> <span class="no">target</span>)$
    <span class="fu">set_auto_fields</span>(<span class="no">target</span>,
                    <span class="kw">anti_collision_field</span> <span class="kw">=</span> <span class="st">'db'</span>)$
    <span class="fu">to_df</span>() <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">da</span>, <span class="no">db</span>)</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["da"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["f_str"],"name":[3],"type":["chr"],"align":["left"]},{"label":["f_int32"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"2","3":"D","4":"4"},{"1":"1","2":"3","3":"F","4":"6"},{"1":"1","2":"4","3":"H","4":"8"},{"1":"2","2":"3","3":"E","4":"5"},{"1":"2","2":"4","3":"G","4":"7"},{"1":"4","2":"5","3":"I","4":"9"},{"1":"5","2":"6","3":"J","4":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">conn</span>$
    <span class="fu">compile_df</span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">f_str</span> <span class="kw">=</span> <span class="no">LETTERS</span>[<span class="fl">4</span>:<span class="fl">10</span>], <span class="kw">f_int32</span> <span class="kw">=</span> <span class="fl">4</span>:<span class="fl">10</span>, <span class="kw">da</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>)), <span class="kw">template</span> <span class="kw">=</span> <span class="no">empty_target</span>)$
    <span class="fu">set_auto_fields</span>(<span class="no">empty_target</span>,
                    <span class="kw">anti_collision_field</span> <span class="kw">=</span> <span class="st">'db'</span>)$
    <span class="fu">to_df</span>() <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">da</span>, <span class="no">db</span>)</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["da"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["f_str"],"name":[3],"type":["chr"],"align":["left"]},{"label":["f_int32"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"0","3":"D","4":"4"},{"1":"1","2":"1","3":"F","4":"6"},{"1":"1","2":"2","3":"H","4":"8"},{"1":"2","2":"0","3":"E","4":"5"},{"1":"2","2":"1","3":"G","4":"7"},{"1":"4","2":"0","3":"I","4":"9"},{"1":"5","2":"0","3":"J","4":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Notice there are no duplicated tuples of (da, db) so they can be safely inserted into the target array without coordinate collisions.</p>
<p>We can comibne the two types of auto fields in one run and update the target array.</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">conn</span>$
    <span class="fu">compile_df</span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">f_str</span> <span class="kw">=</span> <span class="no">LETTERS</span>[<span class="fl">4</span>:<span class="fl">10</span>], <span class="kw">da</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>)), <span class="kw">template</span> <span class="kw">=</span> <span class="no">target</span>, <span class="kw">build_dim_spec</span> <span class="kw">=</span> <span class="st">"z"</span>)$
    <span class="fu">set_auto_fields</span>(<span class="no">target</span>,
                    <span class="kw">source_auto_increment</span> <span class="kw">=</span> <span class="st">"z"</span>,
                    <span class="kw">target_auto_increment</span> <span class="kw">=</span> <span class="st">"f_int64"</span>,
                    <span class="kw">anti_collision_field</span> <span class="kw">=</span> <span class="st">'db'</span>)$
    <span class="fu">mutate</span>(<span class="kw">f_int32</span> <span class="kw">=</span> <span class="fu">int32</span>(<span class="no">null</span>))$
    <span class="fu">change_schema</span>(<span class="no">target</span>)$
    <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="no">target</span>)$
    <span class="fu">execute</span>()

<span class="no">target</span>$<span class="fu">to_df_all</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["da"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["f_str"],"name":[3],"type":["chr"],"align":["left"]},{"label":["f_int32"],"name":[4],"type":["int"],"align":["right"]},{"label":["f_int64"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"a","4":"1","5":"11"},{"1":"1","2":"2","3":"D","4":"NA","5":"21"},{"1":"1","2":"3","3":"F","4":"NA","5":"23"},{"1":"1","2":"4","3":"H","4":"NA","5":"25"},{"1":"2","2":"2","3":"b","4":"2","5":"12"},{"1":"2","2":"3","3":"E","4":"NA","5":"22"},{"1":"2","2":"4","3":"G","4":"NA","5":"24"},{"1":"3","2":"3","3":"c","4":"3","5":"13"},{"1":"4","2":"4","3":"d","4":"4","5":"14"},{"1":"4","2":"5","3":"I","4":"NA","5":"26"},{"1":"5","2":"5","3":"e","4":"5","5":"15"},{"1":"5","2":"6","3":"J","4":"NA","5":"27"},{"1":"6","2":"6","3":"f","4":"6","5":"16"},{"1":"7","2":"7","3":"g","4":"7","5":"17"},{"1":"8","2":"8","3":"h","4":"8","5":"18"},{"1":"9","2":"9","3":"i","4":"9","5":"19"},{"1":"10","2":"10","3":"j","4":"10","5":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="no">conn</span>$
    <span class="fu">compile_df</span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">f_str</span> <span class="kw">=</span> <span class="no">LETTERS</span>[<span class="fl">4</span>:<span class="fl">10</span>], <span class="kw">da</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>)), <span class="kw">template</span> <span class="kw">=</span> <span class="no">target</span>, <span class="kw">build_dim_spec</span> <span class="kw">=</span> <span class="st">"z"</span>)$
    <span class="fu">set_auto_fields</span>(<span class="no">empty_target</span>,
                    <span class="kw">source_auto_increment</span> <span class="kw">=</span> <span class="st">"z"</span>,
                    <span class="kw">target_auto_increment</span> <span class="kw">=</span> <span class="st">"f_int64"</span>,
                    <span class="kw">anti_collision_field</span> <span class="kw">=</span> <span class="st">'db'</span>)$
    <span class="fu">mutate</span>(<span class="kw">f_int32</span> <span class="kw">=</span> <span class="fu">int32</span>(<span class="no">null</span>))$
    <span class="fu">change_schema</span>(<span class="no">empty_target</span>)$
    <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="no">empty_target</span>)$
    <span class="fu">execute</span>()

<span class="no">empty_target</span>$<span class="fu">to_df_all</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["da"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["db"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["f_str"],"name":[3],"type":["chr"],"align":["left"]},{"label":["f_int32"],"name":[4],"type":["int"],"align":["right"]},{"label":["f_int64"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0","3":"D","4":"NA","5":"0"},{"1":"1","2":"1","3":"F","4":"NA","5":"2"},{"1":"1","2":"2","3":"H","4":"NA","5":"4"},{"1":"2","2":"0","3":"E","4":"NA","5":"1"},{"1":"2","2":"1","3":"G","4":"NA","5":"3"},{"1":"4","2":"0","3":"I","4":"NA","5":"5"},{"1":"5","2":"0","3":"J","4":"NA","5":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="co"># clean up</span>
<span class="fu"><a href="https://rdrr.io/r/base/try.html">try</a></span>({
  <span class="no">target</span>$<span class="fu">remove_array</span>()
  <span class="no">empty_target</span>$<span class="fu">remove_array</span>()
}, <span class="kw">silent</span> <span class="kw">=</span> <span class="no">T</span>)</pre></body></html></div>
</div>
<div id="aggregation" class="section level1">
<h1 class="hasAnchor">
<a href="#aggregation" class="anchor"></a>Aggregation</h1>
<div id="group-by-and-then-summarize" class="section level2">
<h2 class="hasAnchor">
<a href="#group-by-and-then-summarize" class="anchor"></a>Group by and then Summarize</h2>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="co"># Tip: Call `dbutils$db_aggregates()$to_df()` to see supported aggregate functions</span>
<span class="no">arr_existing</span>$
  <span class="fu">group_by</span>(<span class="st">"Plant"</span>, <span class="st">"Type"</span>)$
  <span class="fu">summarize</span>(<span class="kw">count</span> <span class="kw">=</span> <span class="fu">count</span>(),
            <span class="kw">uptake_sd</span> <span class="kw">=</span> <span class="fu">stdev</span>(<span class="no">uptake</span>),
            <span class="fu">avg</span>(<span class="no">conc</span>), <span class="co"># unamed fields are named by SciDB</span>
            <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">uptake</span>))$
  <span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["count"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["uptake_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conc_avg"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["uptake_max"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"Quebec","3":"7","4":"8.214766","5":"435","6":"39.7"},{"1":"Mc1","2":"Mississippi","3":"7","4":"4.118657","5":"435","6":"22.2"},{"1":"Qc1","2":"Quebec","3":"7","4":"8.334609","5":"435","6":"38.7"},{"1":"Qn3","2":"Quebec","3":"7","4":"10.349948","5":"435","6":"45.5"},{"1":"Mc2","2":"Mississippi","3":"7","4":"2.186974","5":"435","6":"14.4"},{"1":"Qn2","2":"Quebec","3":"7","4":"11.004069","5":"435","6":"44.3"},{"1":"Mn1","2":"Mississippi","3":"7","4":"8.694251","5":"435","6":"35.5"},{"1":"Mc3","2":"Mississippi","3":"7","4":"3.049044","5":"435","6":"19.9"},{"1":"Mn3","2":"Mississippi","3":"7","4":"6.484707","5":"435","6":"28.5"},{"1":"Qc3","2":"Quebec","3":"7","4":"10.321083","5":"435","6":"41.4"},{"1":"Qc2","2":"Quebec","3":"7","4":"11.336960","5":"435","6":"42.4"},{"1":"Mn2","2":"Mississippi","3":"7","4":"7.652855","5":"435","6":"32.4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb44"><html><body><pre class="r">
<span class="co"># Aggregation result is still an array_op. So we can carry on.</span>
<span class="no">arr_existing</span>$
  <span class="fu">group_by</span>(<span class="st">"Plant"</span>, <span class="st">"Type"</span>)$
  <span class="fu">summarize</span>(<span class="kw">count</span> <span class="kw">=</span> <span class="fu">count</span>(),
            <span class="kw">uptake_sd</span> <span class="kw">=</span> <span class="fu">stdev</span>(<span class="no">uptake</span>),
            <span class="fu">avg</span>(<span class="no">conc</span>),
            <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">uptake</span>))$
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">uptake_sd</span> <span class="kw">&gt;</span> <span class="fl">8</span>)$ <span class="co"># requires uptake standard deviation &gt; 8</span>
  <span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Plant"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["count"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["uptake_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conc_avg"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["uptake_max"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Qn1","2":"Quebec","3":"7","4":"8.214766","5":"435","6":"39.7"},{"1":"Qc1","2":"Quebec","3":"7","4":"8.334609","5":"435","6":"38.7"},{"1":"Qn3","2":"Quebec","3":"7","4":"10.349948","5":"435","6":"45.5"},{"1":"Qn2","2":"Quebec","3":"7","4":"11.004069","5":"435","6":"44.3"},{"1":"Mn1","2":"Mississippi","3":"7","4":"8.694251","5":"435","6":"35.5"},{"1":"Qc3","2":"Quebec","3":"7","4":"10.321083","5":"435","6":"41.4"},{"1":"Qc2","2":"Quebec","3":"7","4":"11.336960","5":"435","6":"42.4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="summarize-without-group_by-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#summarize-without-group_by-fields" class="anchor"></a>Summarize without group_by fields</h2>
<p>Sometimes we need to get stats on array fields for all cells without any group_by fields, e.g. find the max/min value of a field.</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="no">arr_existing</span>$<span class="fu">summarize</span>(
  <span class="fu">count</span>(), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">conc</span>), <span class="fu">stdev</span>(<span class="no">uptake</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">i</span>) <span class="co"># this is a dimension </span>
)$<span class="fu">to_df</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["count"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["conc_max"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["uptake_stdev"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["i_max"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"84","2":"1000","3":"10.81441","4":"84"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="versions" class="section level1">
<h1 class="hasAnchor">
<a href="#versions" class="anchor"></a>Versions</h1>
<p>Since we just modified <code>arr_stored</code> several times. Let’s check out how many versions it has so far and delete the version history.</p>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">arr_stored</span>$<span class="fu">versions</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["version_id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["timestamp"],"name":[2],"type":["S3: POSIXct"],"align":["right"]}],"data":[{"1":"1","2":"2020-09-22 16:23:14"},{"1":"2","2":"2020-09-22 16:23:17"},{"1":"3","2":"2020-09-22 16:23:17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="no">arr_stored</span>$<span class="fu">remove_versions</span>()
<span class="no">arr_stored</span>$<span class="fu">versions</span>()</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["version_id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["timestamp"],"name":[2],"type":["S3: POSIXct"],"align":["right"]}],"data":[{"1":"3","2":"2020-09-22 16:23:17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="read-files" class="section level1">
<h1 class="hasAnchor">
<a href="#read-files" class="anchor"></a>Read Files</h1>
<p><code>fread</code> method of a connection object takes a file path or multiple file paths as input, with other params, and returns an array_op which can be further processed to modify existing arrays or join with other arrays.</p>
<p>If we need to read data from all file columns, use <code>fread</code> without a template. This behaves similarly to <code><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">data.table::fread</a></code>.</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="co"># file column names and types are inferred by peeking into a few lines into the file</span>
<span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">"\t"</span>) <span class="co"># default sep is "\t"</span>

<span class="co"># col.names are V1, V2, ... types are inferred.</span>
<span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">F</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">10</span>) <span class="co"># infer column type using only up to first 10 rows</span>

<span class="co"># file column types are inferred, but names are provided explicitly. col.names can be different than actual file column names but must be the same number as columns.</span>
<span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">col.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"chrom"</span>, <span class="st">"pos"</span>, <span class="st">"ref"</span>, <span class="st">"alt"</span>))
<span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">F</span>, <span class="kw">col.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"chrom"</span>, <span class="st">"pos"</span>, <span class="st">"ref"</span>, <span class="st">"alt"</span>)) <span class="co"># same as above, but read the first row of data</span></pre></body></html></div>
<p>More commonly, we want to load data from file into an existing array. In this case, we provide a template (either array_op or schema string), only the columns whose name matches the template’s fields are imported.</p>
<p><strong>NOTE:</strong> <code>template</code> field types will superceedes actual file column types. If <code>header=T</code>, column names can still be inferred.</p>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">template</span> <span class="kw">=</span> <span class="no">templateArray</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">T</span>)
<span class="co"># template can also be a schema string </span>
<span class="co"># When header = F, we need to provide the correct col.names so they match the template fields.</span>
<span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">template</span> <span class="kw">=</span> <span class="st">"&lt;ref:string, alt:string&gt; [chrom;pos]"</span>,
           <span class="kw">header</span> <span class="kw">=</span> <span class="no">F</span>, <span class="kw">col.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"chrom"</span>, <span class="st">"pos"</span>, <span class="st">"extra_col1"</span>, <span class="st">"ref"</span>, <span class="st">"alt"</span>, <span class="st">"extra_col2"</span>)) <span class="co"># extra_cols ignored</span></pre></body></html></div>
<p>In examples above, <code>fread</code> generates AFL where fields are coerced to the template data types. If no template provided, we can think of the data.frame read from <code>nrows</code> lines of the file as a template. But no all files are perfectly formatted. We often need to error handle ill-formatted fields or missing data.</p>
<p><code>auto_dcast</code> param, if set TRUE, will cast all numerical fields using <code>dcast(a1, double(null))</code> where <code>double</code> can be any numerical types, and <code>a1</code> is the matching field.</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">template</span> <span class="kw">=</span> <span class="no">myArray</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">auto_dcast</span> <span class="kw">=</span> <span class="no">T</span>)</pre></body></html></div>
<p>In case of special field casting, we can provide mutate imported fields on the fly. <code>@</code> is replaced with raw imported string fields, e.g. a0, a1, a2, …</p>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">template</span> <span class="kw">=</span> <span class="no">myArray</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">T</span>,
           <span class="kw">mutate_fields</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">'chrom'</span> <span class="kw">=</span> <span class="st">"iif(@='X', 23, iif(@='Y', 24, dcast(@, int64(null))))"</span>))

<span class="co"># We can still dcast other numeric fields while casting `chrom` differently</span>
<span class="no">conn</span>$<span class="fu">fread</span>(<span class="st">"/file/path"</span>, <span class="kw">template</span> <span class="kw">=</span> <span class="no">myArray</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="no">T</span>,
           <span class="kw">auto_dcast</span> <span class="kw">=</span> <span class="no">T</span>,
           <span class="kw">mutate_fields</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">'chrom'</span> <span class="kw">=</span> <span class="st">"iif(@='X', 23, iif(@='Y', 24, dcast(@, int64(null))))"</span>))</pre></body></html></div>
</div>
<div id="raw-afl" class="section level1">
<h1 class="hasAnchor">
<a href="#raw-afl" class="anchor"></a>Raw AFL</h1>
<p>Hopefully <code>arrayop</code> captures all your common SciDB use cases. In case something is missing, we can run raw AFL statements directly on a ScidbConnection object.</p>
<p>To run AFL statements (in string aka. length-1 R character vector format), use one of the methods of a <code>ScidbConnection</code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>query</code> if we expect results (array attributes as R data frames).</li>
<li>
<code>query_all</code> if we need both array dimensions and attributes.</li>
<li>
<code>execute</code> if we do not expect results</li>
</ol>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">query</span>(<span class="st">"list('operators')"</span>)</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["library"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"add_attributes","2":"scidb"},{"1":"add_instances","2":"system"},{"1":"add_user_to_role","2":"namespaces"},{"1":"aggregate","2":"scidb"},{"1":"aio_input","2":"accelerated_io_tools"},{"1":"aio_save","2":"accelerated_io_tools"},{"1":"apply","2":"scidb"},{"1":"attributes","2":"scidb"},{"1":"avg_rank","2":"scidb"},{"1":"bernoulli","2":"scidb"},{"1":"between","2":"scidb"},{"1":"build","2":"scidb"},{"1":"cancel","2":"scidb"},{"1":"cast","2":"scidb"},{"1":"change_user","2":"namespaces"},{"1":"consume","2":"scidb"},{"1":"create_array","2":"scidb"},{"1":"create_namespace","2":"namespaces"},{"1":"create_role","2":"namespaces"},{"1":"create_user","2":"namespaces"},{"1":"cross_between","2":"scidb"},{"1":"cross_join","2":"scidb"},{"1":"cumulate","2":"scidb"},{"1":"delete","2":"scidb"},{"1":"dimensions","2":"scidb"},{"1":"drop_namespace","2":"namespaces"},{"1":"drop_role","2":"namespaces"},{"1":"drop_user","2":"namespaces"},{"1":"drop_user_from_role","2":"namespaces"},{"1":"echo","2":"scidb"},{"1":"equi_join","2":"equi_join"},{"1":"filter","2":"scidb"},{"1":"flatten","2":"scidb"},{"1":"grouped_aggregate","2":"grouped_aggregate"},{"1":"help","2":"scidb"},{"1":"index_lookup","2":"scidb"},{"1":"input","2":"scidb"},{"1":"insert","2":"scidb"},{"1":"join","2":"scidb"},{"1":"limit","2":"scidb"},{"1":"list","2":"scidb"},{"1":"list_array_residency","2":"system"},{"1":"list_instances","2":"system"},{"1":"load_library","2":"scidb"},{"1":"load_module","2":"scidb"},{"1":"lock_arrays","2":"scidb"},{"1":"merge","2":"scidb"},{"1":"move_array_to_namespace","2":"namespaces"},{"1":"mquery","2":"scidb"},{"1":"parse","2":"accelerated_io_tools"},{"1":"project","2":"scidb"},{"1":"quantile","2":"scidb"},{"1":"rank","2":"scidb"},{"1":"redimension","2":"scidb"},{"1":"regrid","2":"scidb"},{"1":"remove","2":"scidb"},{"1":"remove_instances","2":"system"},{"1":"remove_versions","2":"scidb"},{"1":"rename","2":"scidb"},{"1":"repart","2":"scidb"},{"1":"reshape","2":"scidb"},{"1":"save","2":"scidb"},{"1":"scan","2":"scidb"},{"1":"secure_scan","2":"secure_scan"},{"1":"set_namespace","2":"namespaces"},{"1":"set_role_permissions","2":"namespaces"},{"1":"show","2":"scidb"},{"1":"show_namespace","2":"namespaces"},{"1":"show_role_permissions","2":"namespaces"},{"1":"show_roles_for_user","2":"namespaces"},{"1":"show_user","2":"namespaces"},{"1":"show_user_permissions","2":"namespaces"},{"1":"show_users_in_role","2":"namespaces"},{"1":"slice","2":"scidb"},{"1":"sort","2":"scidb"},{"1":"split","2":"accelerated_io_tools"},{"1":"store","2":"scidb"},{"1":"stream","2":"stream"},{"1":"subarray","2":"scidb"},{"1":"substitute","2":"scidb"},{"1":"summarize","2":"scidb"},{"1":"sync","2":"system"},{"1":"test_clear_cache","2":"scidb"},{"1":"transpose","2":"scidb"},{"1":"unfold","2":"scidb"},{"1":"uniq","2":"scidb"},{"1":"unload_library","2":"scidb"},{"1":"unpack","2":"scidb"},{"1":"unregister_instances","2":"system"},{"1":"variable_window","2":"scidb"},{"1":"versions","2":"scidb"},{"1":"window","2":"scidb"},{"1":"xgrid","2":"scidb"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">query</span>(<span class="st">"op_scidbversion()"</span>)</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["major"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["minor"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["patch"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"19","2":"11","3":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Let’s create an array <code>temp_array</code> in the <code>public</code> namespace for later examples.</p>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">execute</span>(<span class="st">"create array public.temp_array &lt;a:int32, b:string, c:bool&gt; [z]"</span>)
<span class="no">conn</span>$<span class="fu">query</span>(<span class="st">"show(temp_array)"</span>) <span class="co"># query(...) returns result attribtues only</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["schema"],"name":[1],"type":["chr"],"align":["left"]},{"label":["distribution"],"name":[2],"type":["chr"],"align":["left"]},{"label":["etcomp"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"temp_array<a:int32,b:string,c:bool> [z=0:*:0:*]","2":"hashed","3":"none"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">query_all</span>(<span class="st">"show(temp_array)"</span>) <span class="co"># query_all(...) returns result dimesions and attributes</span></pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["i"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["schema"],"name":[2],"type":["chr"],"align":["left"]},{"label":["distribution"],"name":[3],"type":["chr"],"align":["left"]},{"label":["etcomp"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"0","2":"temp_array<a:int32,b:string,c:bool> [z=0:*:0:*]","3":"hashed","4":"none"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="chain-afl-operators-with-pipes" class="section level2">
<h2 class="hasAnchor">
<a href="#chain-afl-operators-with-pipes" class="anchor"></a>Chain AFL operators with pipes</h2>
<p>We can pipe multiple SciDB operators in <code><a href="../reference/afl.html">arrayop::afl</a></code> function which returns an AFL string.</p>
<p>Depending on the number of operands:</p>
<ul>
<li>
<code><a href="../reference/afl.html">afl(a | b)</a></code> is converted to <code>b(a)</code>
</li>
<li>
<code><a href="../reference/afl.html">afl(a | b(c))</a></code> is converted to <code>b(a, c)</code>
</li>
</ul>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="no">conn</span>$<span class="fu">query</span>(<span class="fu"><a href="../reference/afl.html">afl</a></span>(
  <span class="st">"'operators'"</span> <span class="kw">|</span> <span class="no">list</span> <span class="kw">|</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="st">"library != 'scidb'"</span>) <span class="kw">|</span> <span class="fu">limit</span>(<span class="fl">10</span>)
))</pre></body></html></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["library"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"add_instances","2":"system"},{"1":"add_user_to_role","2":"namespaces"},{"1":"aio_input","2":"accelerated_io_tools"},{"1":"aio_save","2":"accelerated_io_tools"},{"1":"change_user","2":"namespaces"},{"1":"create_namespace","2":"namespaces"},{"1":"create_role","2":"namespaces"},{"1":"create_user","2":"namespaces"},{"1":"drop_namespace","2":"namespaces"},{"1":"drop_role","2":"namespaces"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="remove-arrays" class="section level1">
<h1 class="hasAnchor">
<a href="#remove-arrays" class="anchor"></a>Remove arrays</h1>
<p><strong>NOTE:</strong> removed arrays cannot be recovered. Always double check and back up if necessary before entering the danger zone.</p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/try.html">try</a></span>(<span class="no">conn</span>$<span class="fu">execute</span>(<span class="st">"remove(temp_array)"</span>), <span class="kw">silent</span> <span class="kw">=</span> <span class="no">T</span>) <span class="co"># manually remove</span>

<span class="kw">for</span>(<span class="no">x</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">arr_uploaded</span>,
           <span class="no">arr_created</span>,
           <span class="no">arr_created_df</span>,
           <span class="no">arr_existing</span>,
           <span class="no">arr_compiled</span>,
           <span class="no">arr_stored</span>,
           <span class="no">L</span>, <span class="no">R</span>
           )){
  <span class="kw">if</span>(<span class="no">x</span>$<span class="fu">exists_persistent_array</span>()) { <span class="co"># can only remove persistent arrays</span>
    <span class="no">x</span>$<span class="fu">remove_array</span>()
  }
}</pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by  Paradigm4.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
